ans3.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer3)
ans3.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer3)
ans3.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer3)
#Svo er gögninn öll, án NOTA+
hashAnswer4 <- read.csv('Data/hashAnswer4.csv')
hashAnswer4 <- hashAnswer4 %>% subset(select=-c(X))
hashAnswer4$hsta <- hashAnswer4$hsta%>%as.character()
ans4.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer4)
ans4.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer4)
ans4.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer4)
#Teiknum fyrst aðeins gögninn með
p11 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p12 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p13 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p21 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p22 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p23 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p31 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p32 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p33 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p41 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
p42 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
p43 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
grid.arrange(p12, p22, p32, p42, nrow=2)
grid.arrange(p11, p21, p31, p41, nrow=2)
grid.arrange(p11, p21, p31, p41, nrow=2)
grid.arrange(p12, p22, p32, p42, nrow=2)
grid.arrange(p13, p23, p33, p43, nrow=2)
hashAnswer %>% filter(fsfat>100) %>% summarise(n_distinct(studentId))
hashAnswer %>% summarise(n_distinct(studentId))
hashAnswer %>% filter(fsfat>200) %>% summarise(n_distinct(studentId))
hashAnswer %>% filter(fsfat>250) %>% summarise(n_distinct(studentId))
hashAnswer %>% filter(fsfat>300) %>% summarise(n_distinct(studentId))
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
#les inn öll gögninn, nota mestalagi bara answer gagnasafnið
twDb<-src_mysql("tw_quizdb", host = "127.0.0.1", port = 3306, user = "gss24", password = "JuwofKWT2Ewc")
answer <- tbl(twDb, "answer")
answer <- answer%>% filter(timeStart>'2020-01-01 01:00:00')
question <- tbl(twDb,"question")
#setja upp Svörinn sem við ætlum að skoða
hashes<-read.csv("Data/bighashfile.txt",sep=" ",col.names = c("dir","qName","hash","numQ","notaType"))
hashes$plonePath <- paste(hashes$dir,hashes$qName,sep="")
pathQ<-unique(paste(hashes$dir,hashes$qName,sep=""))
question%>%filter(plonePath%in%pathQ)->myQuestions
answer%>%filter(timeStart>"2020-01-01 00:01:01")->answerRed
inner_join(answerRed,myQuestions) -> myAnswer
as.data.frame(myAnswer) -> MyAnswer
#Set inn fjöldi svara framAd Thessu og hefséð áður
MyAnswer <- MyAnswer[order(MyAnswer$timeStart),] %>% group_by(lectureId,studentId) %>% mutate(fsfat=row_number()-1)
hashAnswer <- inner_join(MyAnswer,hashes)
minstadagsetning <- hashAnswer %>% group_by(studentId,hash) %>% summarise('mindag'=min(timeStart))
hashAnsdag <- full_join(hashAnswer,minstadagsetning)
hashAnsdag2 <- hashAnsdag
hashAnsdag2$hsta <- ifelse(hashAnsdag2$mindag==hashAnsdag2$timeStart | hashAnsdag2$hash=='NOTA+',0,1)
hashAnsdag3 <- hashAnsdag %>% group_by(lectureId,studentId,hash) %>% summarise('minNotadag'=min(timeStart)) %>%
full_join(hashAnsdag)
hashAnsdag3$hsta <- ifelse(hashAnsdag3$mindag==hashAnsdag3$timeStart |
(hashAnsdag3$hash=='NOTA+' & hashAnsdag3$minNotadag==hashAnsdag3$timeStart),0,1)
hashAnsdag$hsta <- ifelse(hashAnsdag$mindag==hashAnsdag$timeStart,0,1)
hashAnsdag4 <- hashAnsdag[!grepl('NOTA+',hashAnsdag$hash),]
#Vel dálka og save-a
hashanswers <- hashAnsdag %>% dplyr::select(lectureId,studentId,questionId,correct,hash,fsfat,hsta)
hashanswers2 <- hashAnsdag2 %>% dplyr::select(lectureId,studentId,questionId,correct,hash,fsfat,hsta)
hashanswers3 <- hashAnsdag3 %>% dplyr::select(lectureId,studentId,questionId,correct,hash,fsfat,hsta)
hashanswers4 <- hashAnsdag4 %>% dplyr::select(lectureId,studentId,questionId,correct,hash,fsfat,hsta)
write.csv(hashanswers,'Data/hashAnswer.csv')
write.csv(hashanswers2,'data/hashAnswer2.csv')
write.csv(hashanswers3,'Data/hashAnswer3.csv')
write.csv(hashanswers4,'Data/hashAnswer4.csv')
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
library(gridExtra)
#lesum inn gögninn okkar, fyrst fyrir NOTA+ skoðað eins og hitt
hashAnswer <- read.csv('Data/hashAnswer.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
ans.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer)
ans.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer)
ans.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer)
#næst fyrir þegar NOTA+ er horft á aðeins öðruvísi
hashAnswer2 <- read.csv('Data/hashAnswer2.csv')
hashAnswer2 <- hashAnswer2 %>% subset(select=-c(X))
hashAnswer2$hsta <- hashAnswer2$hsta%>%as.character()
ans2.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer2)
ans2.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer2)
ans2.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer2)
#næst er að skoða fyrir þegar NOTA + er horft á miðað við fyrst skiptið í hverjum fyrirlestri
hashAnswer3 <- read.csv('Data/hashAnswer3.csv')
hashAnswer3 <- hashAnswer3 %>% subset(select=-c(X))
hashAnswer3$hsta <- hashAnswer3$hsta%>%as.character()
ans3.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer3)
ans3.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer3)
ans3.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer3)
#Svo er gögninn öll, án NOTA+
hashAnswer4 <- read.csv('Data/hashAnswer4.csv')
hashAnswer4 <- hashAnswer4 %>% subset(select=-c(X))
hashAnswer4$hsta <- hashAnswer4$hsta%>%as.character()
ans4.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer4)
ans4.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer4)
ans4.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer4)
#?glm
#Teiknum fyrst aðeins gögninn með
p11 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p12 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p13 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p21 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p22 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p23 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p31 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p32 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p33 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p41 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
p42 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
p43 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
hashAnswer %>% group_by(lectureId) %>% summarise(n_distinct(hash))
hashAnswer %>% filter(fsfat>300) %>% summarise(n_distinct(studentId),n_distinct(hash))
hashAnswer %>% filter(fsfat>300) %>% group_by(lectureId) %>%s ummarise(n_distinct(studentId),n_distinct(hash))
hashAnswer %>% filter(fsfat>300) %>% group_by(lectureId) %>% summarise(n_distinct(studentId),n_distinct(hash))
hashAnswer %>% filter(fsfat>100) %>% group_by(lectureId) %>% summarise(n_distinct(studentId),n_distinct(hash))
hashAnswer %>% group_by(lectureId) %>% summarise(n_distinct(hash))
hashAnswer %>% filter(fsfat>200) %>% group_by(lectureId) %>% summarise(n_distinct(studentId),n_distinct(hash))
y0 <- hashAnswer %>% group_by(lectureId) %>%
summarise("y0 Nem"=n_distinct(studentId),"y0 Svör"=n_distinct(hash))
y100 <- hashAnswer %>% filter(fsfat>100) %>% group_by(lectureId) %>%
summarise("y100 Nem"=n_distinct(studentId),"y100 Svör"=n_distinct(hash))
y150 <- hashAnswer %>% filter(fsfat>150) %>% group_by(lectureId) %>%
summarise("y150 Nem"=n_distinct(studentId),"y150 Svör"=n_distinct(hash))
y200 <- hashAnswer %>% filter(fsfat>200) %>% group_by(lectureId) %>%
summarise("y200 Nem"=n_distinct(studentId),"y200 Svör"=n_distinct(hash))
y250 <- hashAnswer %>% filter(fsfat>250) %>% group_by(lectureId) %>%
summarise("y250 Nem"=n_distinct(studentId),"y250 Svör"=n_distinct(hash))
y300 <- hashAnswer %>% filter(fsfat>300) %>% group_by(lectureId) %>%
summarise("y300 Nem"=n_distinct(studentId),"y300 Svör"=n_distinct(hash))
full_join(y0,y100,y150,y200,y250,y300)
full_join(y0,y100)
full_join(y0,y100) %>% full_join(y150) %>% full_join(y200) %>% full_join(y250) %>% full_join(y300)
view(full_join(y0,y100) %>% full_join(y150) %>% full_join(y200) %>% full_join(y250) %>% full_join(y300))
View(full_join(y0,y100) %>% full_join(y150) %>% full_join(y200) %>% full_join(y250) %>% full_join(y300))
#lesum inn gögninn okkar, fyrst fyrir NOTA+ skoðað eins og hitt
hashAnswer <- read.csv('Data/hashAnswer.csv')
hashAnswer <- hashAnswer %>% filter(fsfat<200)
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
ans.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer)
ans.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer)
ans.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer)
#næst fyrir þegar NOTA+ er horft á aðeins öðruvísi
hashAnswer2 <- read.csv('Data/hashAnswer2.csv')
hashAnswer2 <- hashAnswer2 %>% filter(fsfat<200)
hashAnswer2 <- hashAnswer2 %>% subset(select=-c(X))
hashAnswer2$hsta <- hashAnswer2$hsta%>%as.character()
ans2.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer2)
ans2.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer2)
ans2.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer2)
#næst er að skoða fyrir þegar NOTA + er horft á miðað við fyrst skiptið í hverjum fyrirlestri
hashAnswer3 <- read.csv('Data/hashAnswer3.csv')
hashAnswer3 <- hashAnswer3 %>% filter(fsfat<200)
hashAnswer3 <- hashAnswer3 %>% subset(select=-c(X))
hashAnswer3$hsta <- hashAnswer3$hsta%>%as.character()
ans3.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer3)
ans3.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer3)
ans3.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer3)
#Svo er gögninn öll, án NOTA+
hashAnswer4 <- read.csv('Data/hashAnswer4.csv')
hashAnswer4 <- hashAnswer4 %>% filter(fsfat<200)
hashAnswer4 <- hashAnswer4 %>% subset(select=-c(X))
hashAnswer4$hsta <- hashAnswer4$hsta%>%as.character()
ans4.glm <- glm(correct~fsfat,family = binomial(link="logit"),data=hashAnswer4)
ans4.glm2 <- glm(correct~fsfat+hsta,family = binomial(link="logit"),data=hashAnswer4)
ans4.glm3 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswer4)
#?glm
#Teiknum fyrst aðeins gögninn með
p11 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p12 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p13 <- ggplot(data=cbind(hashAnswer,pred=predict.glm(ans.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer1")
p21 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p22 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p23 <- ggplot(data=cbind(hashAnswer2,pred=predict.glm(ans2.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer2")
p31 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p32 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p33 <- ggplot(data=cbind(hashAnswer3,pred=predict.glm(ans3.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer3")
p41 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm,type = "response")),aes(x=fsfat,y=correct))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
p42 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm2,type = "response")),aes(x=fsfat,y=correct,color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
p43 <- ggplot(data=cbind(hashAnswer4,pred=predict.glm(ans4.glm3,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Answer4")
grid.arrange(p13, p23, p33, p43, nrow=2)
summary(ans.glm3)
summary(ans2.glm3)
summary(ans.glm3)
summary(ans3.glm3)
summary(ans4.glm3)
summary(ans2.glm3)
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
library(gridExtra)
#lesum inn gögninn okkar
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
#Skoðum stuttlega þegar skorið er af gögnunum
hashAnswery150 <- hashAnswer%>% filter(fsfat>150)
hashAnswery200 <- hashAnswer%>% filter(fsfat>200)
hashAnswery250 <- hashAnswer%>% filter(fsfat>250)
hashAnswery300 <- hashAnswer%>% filter(fsfat>150)
hashAnswery150 <- hashAnswer%>% filter(fsfat<150)
hashAnswery200 <- hashAnswer%>% filter(fsfat<200)
hashAnswery250 <- hashAnswer%>% filter(fsfat<250)
hashAnswery300 <- hashAnswer%>% filter(fsfat<300)
ans.glm150 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswery150)
ans.glm200 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswery200)
ans.glm250 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswery250)
ans.glm300 <- glm(correct~fsfat*hsta,family = binomial(link="logit"),data=hashAnswery300)
p1 <- ggplot(data=cbind(hashAnswery150,pred=predict.glm(ans.glm150,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 150")
p2 <- ggplot(data=cbind(hashAnswery200,pred=predict.glm(ans.glm200,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 200")
p3 <- ggplot(data=cbind(hashAnswery250,pred=predict.glm(ans.glm250,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 250")
p4 <- ggplot(data=cbind(hashAnswery300,pred=predict.glm(ans.glm300,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 300")
grid.arrange(p1, p2, p3, p4, nrow= 2)
p1 <- ggplot(data=cbind(hashAnswery150,pred=predict.glm(ans.glm150,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 150")+
annotate("text",x=150,y=0.5,label= paste("fjoldi nemenda sem fóru lengra er",hashAnswer%>%
filter(fsfat>150) %>% summarise(n_distinct(student)), sep = " " ))
p1 <- ggplot(data=cbind(hashAnswery150,pred=predict.glm(ans.glm150,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 150")+
annotate("text",x=150,y=0.5,label= paste("fjoldi nemenda sem fóru lengra er",hashAnswer%>%
filter(fsfat>150) %>% summarise(n_distinct(studentId)), sep = " " ))
p1
p1 <- ggplot(data=cbind(hashAnswery150,pred=predict.glm(ans.glm150,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 150")+
annotate("text",x=100,y=0.4,label= paste("fjoldi nemenda sem fóru lengra er",hashAnswer%>%
filter(fsfat>150) %>% summarise(n_distinct(studentId)), sep = " " ))
p1
p1 <- ggplot(data=cbind(hashAnswery150,pred=predict.glm(ans.glm150,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 150")+
annotate("text",x=100,y=0.4,label= paste("fjoldi nemenda sem fóru lengra er",hashAnswer%>%
filter(fsfat>150) %>% summarise(n_distinct(studentId)), sep = " " ))
p2 <- ggplot(data=cbind(hashAnswery200,pred=predict.glm(ans.glm200,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 200")+
annotate("text",x=150,y=0.4,label= paste("fjoldi nemenda sem fóru lengra er",hashAnswer%>%
filter(fsfat>200) %>% summarise(n_distinct(studentId)), sep = " " ))
p3 <- ggplot(data=cbind(hashAnswery250,pred=predict.glm(ans.glm250,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 250")+
annotate("text",x=200,y=0.4,label= paste("fjoldi nemenda sem fóru lengra er",hashAnswer%>%
filter(fsfat>250) %>% summarise(n_distinct(studentId)), sep = " " ))
p4 <- ggplot(data=cbind(hashAnswery300,pred=predict.glm(ans.glm300,type = "response")),aes(x=fsfat,y=correct, color=hsta))+
geom_point()+
geom_line(aes(y=pred))+
ggtitle("Undir 300")+
annotate("text",x=250,y=0.4,label= paste("fjoldi nemenda sem fóru lengra er",hashAnswer%>%
filter(fsfat>300) %>% summarise(n_distinct(studentId)), sep = " " ))
grid.arrange(p1, p2, p3, p4, nrow= 2)
medalskod <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise(mean(correct))
medalskod <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct))
ggplot(medalskod, aes(x=fsfat,y=med,color=hsta))+
geom_line()
medalskod <- hashAnswer %>% filter(fsfat<100) %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct))
ggplot(medalskod, aes(x=fsfat,y=med,color=hsta))+
geom_line()
fjoldinem <- hashAnswer %>% group_by(fsfat) %>% summarise("fjoldi"=n_distinct(studentId))
hashAnswer %>% group_by(fsfat) %>% summarise("fjoldi"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=fjoldi))+
geom_line()
hashAnswer %>% filter(fsfat<100) %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_line()
p5 <- hashAnswer %>% filter(fsfat<100) %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_line()
p6 <- hashAnswer %>% group_by(fsfat) %>% summarise("fjoldi"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=fjoldi))+
geom_line()
grid.arrange(p5,p6,nrow=1)
p6 <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("fjoldi"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=fjoldi,color=hsta))+
geom_line()
grid.arrange(p5,p6,nrow=1)
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_point()
p5
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_point()+
geom_smooth()
p5
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct)) %>% filter(med>0&med<1)
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct)) %>% filter(med>0&med<1) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_point()+
geom_smooth()
p5
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct),"fjold"=n_distinct(studentId)) %>%
filter(med==0|med==1) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_point()
p5
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct),"fjold"=n_distinct(studentId)) %>%
filter(med>0&med<1) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_point()+
geom_smooth()
p5
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% summarise("med"=mean(correct),"fjold"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_point()+
geom_smooth()
p5
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% filter(fsfat<100) %>%
summarise("med"=mean(correct),"fjold"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta))+
geom_point()+
geom_smooth()
p5
p6 <- hashAnswer %>% group_by(fsfat,hsta) %>% filter(fsfat<100) %>%
summarise("fjoldi"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=fjoldi,color=hsta))+
geom_line()
p6
grid.arrange(p5,p6,nrow=1)
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% filter(fsfat<100) %>%
summarise("med"=mean(correct),"fjold"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta), show.legend=FALSE)+
geom_point()+
geom_smooth()
p6 <- hashAnswer %>% group_by(fsfat,hsta) %>% filter(fsfat<100) %>%
summarise("fjoldi"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=fjoldi,color=hsta), show.legend=FALSE)+
geom_line()
grid.arrange(p5,p6,nrow=1)
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% filter(fsfat<100) %>%
summarise("med"=mean(correct),"fjold"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta), show.legend=FALSE)+
geom_point(show.legend = FALSE)+
geom_smooth(show.legend = FALSE)
p6 <- hashAnswer %>% group_by(fsfat,hsta) %>% filter(fsfat<100) %>%
summarise("fjoldi"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=fjoldi,color=hsta))+
geom_line(show.legend = FALSE)
grid.arrange(p5,p6,nrow=1)
summary(ans.glm150)
summary(ans.glm200)
summary(ans.glm250)
summary(ans.glm300)
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
library(gridExtra)
#lesum inn gögninn okkar
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
ggplot(hashAnswer,aes(x=fsfat,y=hsta))+geom_count()
p5 <- hashAnswer %>% group_by(fsfat,hsta) %>% filter(fsfat<100) %>%
summarise("med"=mean(correct),"fjold"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=med,color=hsta), show.legend=FALSE)+
geom_point(show.legend = FALSE)+
geom_smooth(show.legend = FALSE)
p6 <- hashAnswer %>% group_by(fsfat,hsta) %>% filter(fsfat<100) %>%
summarise("fjoldi"=n_distinct(studentId)) %>%
ggplot(aes(x=fsfat,y=fjoldi,color=hsta))+
geom_line(show.legend = FALSE)
grid.arrange(p5,p6,nrow=1)
hashAnswer %>% group_by(lectureId) %>% summarise(n_distinct(hash))
