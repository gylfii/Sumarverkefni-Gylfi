TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
print(FPR)
print(TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line() +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01))) +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlim("False Positive Rate") +
ylim("True Positive Rate")
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in length(threshold)) {
FP <- 0
TP <- 0
print(j)
thresh <- threshold[j]
for (i in length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
print(FPR)
print(TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line() +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01))) +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlim("False Positive Rate") +
ylim("True Positive Rate")
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1 <- ROCDraw(hashTest2, ans42)
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
print(FPR)
print(TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line() +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01))) +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlim("False Positive Rate") +
ylim("True Positive Rate")
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
print(FPR)
print(TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line() +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01))) +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlab("False Positive Rate") +
ylab("True Positive Rate")
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line() +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01)), aes(x = x, y = y)) +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlab("False Positive Rate") +
ylab("True Positive Rate")
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
?geom_line
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line() +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01)), aes(x = x, y = y, linetype = "dashed")) +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlab("False Positive Rate") +
ylab("True Positive Rate")
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line(color = "orange") +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01)), aes(x = x, y = y), linetype = "dashed") +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlab("False Positive Rate") +
ylab("True Positive Rate")
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
?area
?geom_area
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line(color = "orange") +
geom_area(fill = "lightblue")+
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01)), aes(x = x, y = y), linetype = "dashed") +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlab("False Positive Rate") +
ylab("True Positive Rate") +
xlim(0, 1) +
ylim(0, 1)
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_line(color = "orange") +
geom_area(fill = "lightblue")+
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01)), aes(x = x, y = y), linetype = "dashed") +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlab("False Positive Rate") +
ylab("True Positive Rate") +
coord_cartesian(xlim = c(0, 1), ylim = c(0, 1))
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
?geom_line
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_area(fill = "lightblue")+
geom_line(color = "orange", size = 2) +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01)), aes(x = x, y = y), linetype = "dashed") +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlab("False Positive Rate") +
ylab("True Positive Rate") +
coord_cartesian(xlim = c(0, 1), ylim = c(0, 1))
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
#Teiknum ROC
ROCDraw <- function(df, modl) {
score <- predict(modl, type = "response")
y <- df$correct
#False positive rate
FPR <- 0
#true positive rate
TPR <- 0
#setjum upp threshold
threshold <- seq(from = 0, to = 1, by = 0.01)
# number of positive and negative
P <- sum(y)
N <- length(y) - P
#Iterate through all thresholds
for (j in 1:length(threshold)) {
FP <- 0
TP <- 0
thresh <- threshold[j]
for (i in 1:length(score)) {
if (score[i] >= thresh) {
if (y[i] == 1){
TP <- TP + 1
}
if (y[i] == 0){
FP <- FP + 1
}
}
}
FPR[j] <- FP/N
TPR[j] <- TP/P
}
#Reiknum AUC með trapezoid reglunni
auc <- -1 * trapz(FPR, TPR)
#Að lokum teiknum við aðeins upp
p <- data.frame(x = FPR, y = TPR) %>%
ggplot(aes(x = FPR, y = TPR)) +
geom_area(fill = "lightblue")+
geom_line(color = "orange", size = 1.5) +
geom_line(data = data.frame(x = seq(0, 1, 0.01), y = seq(0, 1, 0.01)), aes(x = x, y = y), linetype = "dashed") +
labs(title = paste0("ROC curve, AUC = ", round(auc, digits = 4))) +
xlab("False Positive Rate") +
ylab("True Positive Rate") +
coord_cartesian(xlim = c(0, 1), ylim = c(0, 1))
return(p)
}
p1 <- ROCDraw(hashTest2, ans42)
p1
p2 <- ROCDraw(hashTest2, ans22)
p2
grid.arrange(p1, p2, nrow = 1)
