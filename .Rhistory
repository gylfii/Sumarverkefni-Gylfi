fullt50 <- createUsable(hashLim50)
fullt50 %>% kable(longtable = T, digits = 5, booktabs = T) %>%
kable_styling() %>%
pack_rows("correct", 1, 2) %>%
pack_rows("hsta", 3, 4) %>%
pack_rows("hluta2", 5, 9) %>%
pack_rows("lectureId", 10, 22) %>%
column_spec(1, width = "4cm")
hashAnswer$hluta <- hashAnswer$hluta %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean3 <- hashAnswer %>% filter(fsfat < 50) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean3 <- hashAnswer %>% filter(fsfat < 50) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
p2 <- dfmean3 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean2 %>% filter(fjoldi > 5), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim, ymaxim))
yminim <- min(dfmean3$med)
ymaxim <- max(dfmean3$med)
p2 <- dfmean3 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean2 %>% filter(fjoldi > 5), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim, ymaxim))
p1 <- dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
p3 <- dfmean2 %>% filter(fjoldi > 5) %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
ggsave('Img/meanbyhlutfall.png', p1, width = 10, height = 10)
ggsave('Img/meabwhsbyhlutfall.png', p2, width = 10, height = 10)
ggsave('Img/meanbyhlutfallLim.png', p3, width = 10, height = 10)
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
library(gridExtra)
library(tidyverse)
library(modelr)
library(rlang)
library(lme4)
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean3 <- hashAnswer %>% filter(fsfat < 50) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
p2 <- dfmean3 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean2 %>% filter(fjoldi > 5), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim, ymaxim))
yminim <- min(dfmean3$med)
ymaxim <- max(dfmean3$med)
p2 <- dfmean3 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean2 %>% filter(fjoldi > 5), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim, ymaxim))
p1 <- dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
p3 <- dfmean2 %>% filter(fjoldi > 5) %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
ggsave('Img/meanbyhlutfall.png', p1, width = 10, height = 10)
ggsave('Img/meabwhsbyhlutfall.png', p2, width = 10, height = 10)
ggsave('Img/meanbyhlutfallLim.png', p3, width = 10, height = 10)
p2 <- dfmean3 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean2 %>% filter(fjoldi > 2), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim, ymaxim))
p2
p1 <- dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
p3 <- dfmean2 %>% filter(fjoldi > 2) %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
ggsave('Img/meanbyhlutfall.png', p1, width = 10, height = 10)
ggsave('Img/meabwhsbyhlutfall.png', p2, width = 10, height = 10)
ggsave('Img/meanbyhlutfallLim.png', p3, width = 10, height = 10)
knitr::opts_chunk$set(echo = TRUE)
source('Script/Settings.R')
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$nicc <- hashAnswer$nicc %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
createUsable <- function(df){
t <- table(df$hsta)
fr1 <- rbind(fjoldi = t, hlutfall = prop.table(t)) %>% t()
t2 <- table(df$lectureId)
fr2 <- rbind(fjoldi = t2, hlutfall = prop.table(t2)) %>% t()
t3 <- table(df$correct)
fr3 <- rbind(fjoldi = t3, hlutfall = prop.table(t3)) %>% t()
t4 <- table(df$hluta2)
fr4 <- rbind(fjoldi = t4, hlutfall = prop.table(t4)) %>% t()
fullthing <- rbind(fr3, fr1, fr4, fr2)
fullthing[, 2] <- paste0(round(fullthing[, 2] * 100, digits = 1), "%")
row.names(fullthing) <- c("Rangt", "Rétt", "Sést í fyrsta skipti", "Hef séð svarið áður",
"0% - 20%", "20% - 40%", "40% - 60%", "60% - 80%", "80% - 100%",
3082, 3201, 3202, 3203, 3204, 3208, 3209, 3210, 3211, 3212, 3213, 3214, 3215)
return(fullthing)
}
fullthing <- createUsable(hashAnswer)
fullthing %>% kable(longtable = T, digits = 5, booktabs = T) %>%
kable_styling() %>%
pack_rows("correct", 1, 2) %>%
pack_rows("hsta", 3, 4) %>%
pack_rows("hluta2", 5, 9) %>%
pack_rows("lectureId", 10, 22) %>%
column_spec(1, width = "4cm")
a <- hashAnswer %>% summarise("FY50" = sum(fsfat >= 50), "FY100" = sum(fsfat >= 100),
"FY150" = sum(fsfat >= 150), "FY200" = sum(fsfat >= 200),
"FY250" = sum(fsfat >= 250), "FY300" = sum(fsfat >= 300))
b <- hashAnswer %>% summarise("HY50" = mean(fsfat >= 50), "HY100" = mean(fsfat >= 100),
"HY150" = mean(fsfat >= 150), "HY200" = mean(fsfat >= 200),
"HY250" = mean(fsfat >= 250), "HY300" = mean(fsfat >= 300))
ab <- cbind(a, b)
FHbylim <- ab %>% pivot_longer(c('FY50', 'HY50', 'FY100', 'HY100', 'FY150', 'HY150', 'FY200', 'HY200', 'FY250', 'HY250', 'FY300', 'HY300'),
names_to = "typewLim", values_to = "values") %>%
separate(typewLim, into = c("type", "limit"), sep = 2) %>% pivot_wider(names_from = type, values_from = values)
FHbylim$HY <- paste0(round(FHbylim$HY * 100, digits = 1), "%")
FHbylim %>% kable(digits = 4, booktabs = T) %>%
kable_styling()
hashLim50 <- hashAnswer %>% group_by(studentId) %>% mutate("count" = n()) %>%
filter(count > 7 & fsfat < 50)
hashLim100 <- hashAnswer %>% group_by(studentId) %>% mutate("count" = n()) %>%
filter(count > 7 & fsfat < 100)
fullt100 <- createUsable(hashLim100)
fullt100 %>% kable(longtable = T, digits = 5, booktabs = T) %>%
kable_styling() %>%
pack_rows("correct", 1, 2) %>%
pack_rows("hsta", 3, 4) %>%
pack_rows("hluta2", 5, 9) %>%
pack_rows("lectureId", 10, 22) %>%
column_spec(1, width = "4cm")
fullt50 <- createUsable(hashLim50)
fullt50 %>% kable(longtable = T, digits = 5, booktabs = T) %>%
kable_styling() %>%
pack_rows("correct", 1, 2) %>%
pack_rows("hsta", 3, 4) %>%
pack_rows("hluta2", 5, 9) %>%
pack_rows("lectureId", 10, 22) %>%
column_spec(1, width = "4cm")
include_graphics('Imgsimplify/plotbymean50.png')
include_graphics('Imgsimplify/plotbymean100.png')
include_graphics('Img/meanbyhlutfall.png')
p3 <- dfmean2 %>% filter(fjoldi > 1) %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
p3
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
p3 <- dfmean2 %>% filter(fjoldi > 1) %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
p3
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
library(gridExtra)
library(tidyverse)
library(modelr)
library(rlang)
library(lme4)
?glmer
#lesum inn gögninn okkar
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean3 <- hashAnswer %>% filter(fsfat < 50) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
p2 <- dfmean3 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean2 %>% filter(fjoldi > 1), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim, ymaxim))
yminim <- min(dfmean3$med)
ymaxim <- max(dfmean3$med)
p1 <- dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
p3 <- dfmean2 %>% filter(fjoldi > 1) %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F)
p2 <- dfmean3 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean2 %>% filter(fjoldi > 1), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim, ymaxim))
ggsave('Img/meanbyhlutfall.png', p1, width = 10, height = 10)
ggsave('Img/meabwhsbyhlutfall.png', p2, width = 10, height = 10)
ggsave('Img/meanbyhlutfallLim.png', p3, width = 10, height = 10)
knitr::opts_chunk$set(echo = TRUE)
source('Script/Settings.R')
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$nicc <- hashAnswer$nicc %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
createUsable <- function(df){
t <- table(df$hsta)
fr1 <- rbind(fjoldi = t, hlutfall = prop.table(t)) %>% t()
t2 <- table(df$lectureId)
fr2 <- rbind(fjoldi = t2, hlutfall = prop.table(t2)) %>% t()
t3 <- table(df$correct)
fr3 <- rbind(fjoldi = t3, hlutfall = prop.table(t3)) %>% t()
t4 <- table(df$hluta2)
fr4 <- rbind(fjoldi = t4, hlutfall = prop.table(t4)) %>% t()
fullthing <- rbind(fr3, fr1, fr4, fr2)
fullthing[, 2] <- paste0(round(fullthing[, 2] * 100, digits = 1), "%")
row.names(fullthing) <- c("Rangt", "Rétt", "Sést í fyrsta skipti", "Hef séð svarið áður",
"0% - 20%", "20% - 40%", "40% - 60%", "60% - 80%", "80% - 100%",
3082, 3201, 3202, 3203, 3204, 3208, 3209, 3210, 3211, 3212, 3213, 3214, 3215)
return(fullthing)
}
fullthing <- createUsable(hashAnswer)
fullthing %>% kable(longtable = T, digits = 5, booktabs = T) %>%
kable_styling() %>%
pack_rows("correct", 1, 2) %>%
pack_rows("hsta", 3, 4) %>%
pack_rows("hluta2", 5, 9) %>%
pack_rows("lectureId", 10, 22) %>%
column_spec(1, width = "4cm")
a <- hashAnswer %>% summarise("FY50" = sum(fsfat >= 50), "FY100" = sum(fsfat >= 100),
"FY150" = sum(fsfat >= 150), "FY200" = sum(fsfat >= 200),
"FY250" = sum(fsfat >= 250), "FY300" = sum(fsfat >= 300))
b <- hashAnswer %>% summarise("HY50" = mean(fsfat >= 50), "HY100" = mean(fsfat >= 100),
"HY150" = mean(fsfat >= 150), "HY200" = mean(fsfat >= 200),
"HY250" = mean(fsfat >= 250), "HY300" = mean(fsfat >= 300))
ab <- cbind(a, b)
FHbylim <- ab %>% pivot_longer(c('FY50', 'HY50', 'FY100', 'HY100', 'FY150', 'HY150', 'FY200', 'HY200', 'FY250', 'HY250', 'FY300', 'HY300'),
names_to = "typewLim", values_to = "values") %>%
separate(typewLim, into = c("type", "limit"), sep = 2) %>% pivot_wider(names_from = type, values_from = values)
FHbylim$HY <- paste0(round(FHbylim$HY * 100, digits = 1), "%")
FHbylim %>% kable(digits = 4, booktabs = T) %>%
kable_styling()
hashLim50 <- hashAnswer %>% group_by(studentId) %>% mutate("count" = n()) %>%
filter(count > 7 & fsfat < 50)
hashLim100 <- hashAnswer %>% group_by(studentId) %>% mutate("count" = n()) %>%
filter(count > 7 & fsfat < 100)
fullt100 <- createUsable(hashLim100)
fullt100 %>% kable(longtable = T, digits = 5, booktabs = T) %>%
kable_styling() %>%
pack_rows("correct", 1, 2) %>%
pack_rows("hsta", 3, 4) %>%
pack_rows("hluta2", 5, 9) %>%
pack_rows("lectureId", 10, 22) %>%
column_spec(1, width = "4cm")
fullt50 <- createUsable(hashLim50)
fullt50 %>% kable(longtable = T, digits = 5, booktabs = T) %>%
kable_styling() %>%
pack_rows("correct", 1, 2) %>%
pack_rows("hsta", 3, 4) %>%
pack_rows("hluta2", 5, 9) %>%
pack_rows("lectureId", 10, 22) %>%
column_spec(1, width = "4cm")
include_graphics('Imgsimplify/plotbymean50.png')
include_graphics('Imgsimplify/plotbymean100.png')
include_graphics('Img/meanbyhlutfall.png')
include_graphics('Img/meanbyhlutfallLim.png')
include_graphics('Img/meabwhsbyhlutfall.png')
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
?geom_text
dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F) +
geom_text(aes(label = fjoldi))
?geom_text
dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F) +
geom_text(aes(label = fjoldi), position = position_dodge(0.9))
dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
#geom_point() +
geom_smooth(se = F) +
geom_text(aes(label = fjoldi), position = position_dodge(0.9))
dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point() +
geom_smooth(se = F) +
geom_text(aes(label = fjoldi), position = position_dodge())
dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
#geom_point() +
geom_smooth(se = F) +
geom_text(aes(label = fjoldi))
#Fyrst eru það þægilegu dplyr og tidyr föllin. Svo RMySQL til að fá aðgang á SQL
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
#Hvað gerir MASS aftur?
library(MASS)
#GGplot gott til að teikna
library(ggplot2)
library(gridExtra)
#Tidyverse er geðveikt
library(tidyverse)
#modelr var fyrir %$% skipanir minnist mig
library(modelr)
#hvað gerir rlang aftur?
library(rlang)
#lme4 og lmerTest er fyrir glmer og fleira þægilegt
library(lme4)
library(lmerTest)
#Car er til að geta notað Anova
library(car)
#cAIC4 er svo það sé hægt að prufa stepcAIC, svo stepAIC fyrir glmer fallið, mun líklega ekki nota, tekur of langan tíma
library(cAIC4)
#til að geta gert trapz fyrir AUC í ROC
library(pracma)
#sma skoda
library(funModeling)
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$nicc <- hashAnswer$nicc %>% as.factor()
hashAnswer$fsfat <- hashAnswer$fsfat/10
hashAnswer$fsvfatu <- hashAnswer$fsvfatu/10
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
hashTest2 <- hashAnswer %>% group_by(studentId) %>% mutate("count" = n()) %>%
filter(count > 7 & fsfat < 10)
options(contrasts = c("contr.sum", "contr.poly"))
hashTest3 <- hashTest2 %>% filter(fsfat < 5)
fit7 <- glmer(correct ~ hluta2 + fsfat + hsta + nicc + gpow + lectureId + (1 | studentId), family = binomial(link = "logit"),
data = hashTest2, nAGQ = 0, control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
Anova(fit7, type = 3)
fit8 <- glmer(correct ~ hluta + fsfat + hsta + nicc + gpow + lectureId + (1 | studentId), family = binomial(link = "logit"),
data = hashTest2, nAGQ = 0, control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
Anova(fit8, type = 3)
cor(hashTest2$fsfat, hashTest2$hluta)
dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point(aes(size = fjoldi)) +
geom_smooth(se = F)
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
library(gridExtra)
library(tidyverse)
library(modelr)
library(rlang)
library(lme4)
?glmer
#lesum inn gögninn okkar
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean2 %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point(aes(size = fjoldi)) +
geom_smooth(se = F)
p3 <- dfmean2 %>% filter(fjoldi > 1) %>% ggplot(aes(x = fsfat, y = med, color = hluta2)) +
geom_point(aes(size = fjoldi)) +
geom_smooth(se = F)
p3
dfmean3 <- hashAnswer %>% filter(fsfat < 100) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
library(gridExtra)
library(tidyverse)
library(modelr)
library(rlang)
library(lme4)
?glmer
#lesum inn gögninn okkar
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean3 <- hashAnswer %>% filter(fsfat < 100) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
dfmean4 <- hashAnswer %>% filter(fsfat < 100 & hsta == "0") %>% group_by(fsfat, hluta2) %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean5 <- hashAnswer %>% filter(fsfat < 100) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
yminim2 <- min(dfmean5$med)
yminim2 <- max(dfmean5$med)
p4 <- dfmean5 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean4 %>% filter(fjoldi > 1), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim2, ymaxim2))
yminim2 <- min(dfmean5$med)
ymaxim2 <- max(dfmean5$med)
p4 <- dfmean5 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean4 %>% filter(fjoldi > 1), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim2, ymaxim2))
p4
p4 <- dfmean5 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean4 %>% filter(fjoldi > 2), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim2, ymaxim2))
p4
p4 <- dfmean5 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean4 %>% filter(fjoldi > 5), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim2, ymaxim2))
p4
p4 <- dfmean5 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean4 %>% filter(fjoldi > 10), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim2, ymaxim2))
p4
p4 <- dfmean5 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean4 %>% filter(fjoldi > 1), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim2, ymaxim2))
p4
library(dbplyr)
library(dplyr)
library(RMySQL)
library(tidyr)
library(MASS)
library(ggplot2)
library(gridExtra)
library(tidyverse)
library(modelr)
library(rlang)
library(lme4)
?glmer
#lesum inn gögninn okkar
hashAnswer <- read.csv('Data/hashAnswer4.csv')
hashAnswer <- hashAnswer %>% subset(select=-c(X))
hashAnswer$hsta <- hashAnswer$hsta%>%as.character()
hashAnswer$lectureId <- hashAnswer$lectureId %>% as.factor()
hashAnswer$studentId <- hashAnswer$studentId %>% as.factor()
hashAnswer$hluta2 <- cut_interval(hashAnswer$hluta, n = 5)
#Mean fyrir hluta og alls konar myndir með því
dfmean2 <- hashAnswer %>% group_by(fsfat, hluta2) %>% filter(fsfat < 50 & hsta == "0") %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean3 <- hashAnswer %>% filter(fsfat < 50) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
dfmean4 <- hashAnswer %>% filter(fsfat < 100 & hsta == "0") %>% group_by(fsfat, hluta2) %>%
summarise("med" = mean(correct), "fjoldi" = n())
dfmean5 <- hashAnswer %>% filter(fsfat < 100) %>% group_by(fsfat, hsta) %>%
summarise("med" = mean(correct), fjoldi = n())
yminim2 <- min(dfmean5$med)
ymaxim2 <- max(dfmean5$med)
p4 <- dfmean5 %>% filter(hsta == 0) %>% ggplot(aes(x = fsfat, y = med)) +
geom_point() +
geom_smooth() +
geom_smooth(data = dfmean4 %>% filter(fjoldi > 1), aes(color = hluta2), se = F) +
coord_cartesian(ylim = c(yminim2, ymaxim2))
p4
ggsave('Img/meabwhsbyhlutfall100.png', p4, width = 10, height = 10)
